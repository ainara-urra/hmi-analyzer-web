<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HMI Analyzer — The Cognitive Joint</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* ═══════════════════════════════════════════
   TOKENS
═══════════════════════════════════════════ */
:root {
  --white: #ffffff;
  --gray-50: #f8f8f7;
  --gray-100: #f0efed;
  --gray-200: #e4e2de;
  --gray-300: #c9c6c0;
  --gray-500: #8a8780;
  --gray-700: #4a4844;
  --gray-900: #1a1917;
  --blue: #1a56db;
  --blue-light: #e8f0fe;
  --blue-dark: #1240a8;
  --green: #166534;
  --green-bg: #f0fdf4;
  --yellow: #854d0e;
  --yellow-bg: #fefce8;
  --red: #991b1b;
  --red-bg: #fef2f2;
  --radius: 10px;
  --radius-lg: 16px;
  --shadow-sm: 0 1px 3px rgba(0,0,0,.06), 0 1px 2px rgba(0,0,0,.04);
  --shadow: 0 4px 16px rgba(0,0,0,.08), 0 1px 4px rgba(0,0,0,.04);
  --shadow-lg: 0 12px 40px rgba(0,0,0,.10), 0 2px 8px rgba(0,0,0,.05);
}

/* ═══════════════════════════════════════════
   RESET & BASE
═══════════════════════════════════════════ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
  font-family: 'Sora', sans-serif;
  background: var(--gray-50);
  color: var(--gray-900);
  font-size: 15px;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
}

/* ═══════════════════════════════════════════
   TOPBAR
═══════════════════════════════════════════ */
.topbar {
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(255,255,255,0.92);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--gray-200);
  padding: 0 40px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.topbar-brand {
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
}

.topbar-brand .wordmark {
  font-size: 15px;
  font-weight: 700;
  color: var(--gray-900);
  letter-spacing: -0.3px;
}

.topbar-brand .badge {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--blue);
  background: var(--blue-light);
  padding: 2px 8px;
  border-radius: 99px;
  font-family: 'DM Mono', monospace;
}

.topbar-right {
  display: flex;
  align-items: center;
  gap: 20px;
}

.topbar-link {
  font-size: 13px;
  color: var(--gray-500);
  text-decoration: none;
  font-weight: 500;
  transition: color .15s;
}
.topbar-link:hover { color: var(--gray-900); }

/* ═══════════════════════════════════════════
   HERO
═══════════════════════════════════════════ */
.hero {
  background: var(--white);
  border-bottom: 1px solid var(--gray-200);
  padding: 64px 40px 56px;
}

.hero-inner {
  max-width: 900px;
  margin: 0 auto;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 48px;
  align-items: center;
}

.hero-eyebrow {
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--blue);
  margin-bottom: 16px;
}

.hero h1 {
  font-size: clamp(28px, 4vw, 40px);
  font-weight: 700;
  line-height: 1.15;
  letter-spacing: -0.8px;
  color: var(--gray-900);
  margin-bottom: 16px;
}

.hero h1 em {
  font-style: normal;
  color: var(--blue);
}

.hero p {
  font-size: 15px;
  color: var(--gray-500);
  max-width: 480px;
  line-height: 1.7;
}

/* Bridge pill strip */
.bridge-strip {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.bridge-pill {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--gray-50);
  border: 1px solid var(--gray-200);
  border-radius: 99px;
  padding: 5px 12px 5px 8px;
  animation: fadeSlideIn 0.4s both;
}

.bridge-pill:nth-child(1) { animation-delay: .05s; }
.bridge-pill:nth-child(2) { animation-delay: .1s; }
.bridge-pill:nth-child(3) { animation-delay: .15s; }
.bridge-pill:nth-child(4) { animation-delay: .2s; }
.bridge-pill:nth-child(5) { animation-delay: .25s; }
.bridge-pill:nth-child(6) { animation-delay: .3s; }
.bridge-pill:nth-child(7) { animation-delay: .35s; }
.bridge-pill:nth-child(8) { animation-delay: .4s; }

@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateX(12px); }
  to   { opacity: 1; transform: translateX(0); }
}

.bridge-pill .num {
  font-family: 'DM Mono', monospace;
  font-size: 9px;
  font-weight: 500;
  color: var(--white);
  background: var(--blue);
  border-radius: 99px;
  width: 20px; height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.bridge-pill .label {
  font-size: 12px;
  font-weight: 600;
  color: var(--gray-700);
  letter-spacing: 0.2px;
}

/* ═══════════════════════════════════════════
   MAIN LAYOUT
═══════════════════════════════════════════ */
.layout {
  max-width: 900px;
  margin: 0 auto;
  padding: 40px 40px 80px;
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 28px;
  align-items: start;
}

/* ═══════════════════════════════════════════
   CARDS
═══════════════════════════════════════════ */
.card {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.card-header {
  padding: 20px 24px 16px;
  border-bottom: 1px solid var(--gray-100);
  display: flex;
  align-items: center;
  gap: 10px;
}

.card-header .step {
  font-family: 'DM Mono', monospace;
  font-size: 10px;
  font-weight: 500;
  color: var(--blue);
  background: var(--blue-light);
  width: 24px; height: 24px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.card-header h2 {
  font-size: 14px;
  font-weight: 600;
  color: var(--gray-900);
  letter-spacing: -0.2px;
}

.card-body { padding: 24px; }

/* ═══════════════════════════════════════════
   UPLOAD ZONE
═══════════════════════════════════════════ */
.upload-zone {
  border: 2px dashed var(--gray-200);
  border-radius: var(--radius);
  padding: 40px 24px;
  text-align: center;
  cursor: pointer;
  transition: border-color .2s, background .2s;
  position: relative;
  background: var(--gray-50);
}

.upload-zone:hover, .upload-zone.over {
  border-color: var(--blue);
  background: var(--blue-light);
}

.upload-zone input {
  position: absolute; inset: 0;
  opacity: 0; cursor: pointer;
  width: 100%; height: 100%;
}

.upload-icon {
  width: 40px; height: 40px;
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 12px;
  box-shadow: var(--shadow-sm);
}

.upload-zone p { font-size: 14px; color: var(--gray-500); }
.upload-zone p strong { color: var(--blue); font-weight: 600; }
.upload-zone small { font-size: 12px; color: var(--gray-300); }

/* File chosen state */
.file-chosen {
  display: none;
  align-items: center;
  gap: 12px;
  background: var(--gray-50);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius);
  padding: 12px 16px;
  margin-top: 12px;
}

.file-chosen .file-icon {
  width: 36px; height: 36px;
  background: var(--blue-light);
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}

.file-chosen .file-name {
  flex: 1;
  font-size: 13px;
  font-weight: 500;
  color: var(--gray-900);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.file-chosen .file-size {
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  color: var(--gray-500);
}

/* Preview */
#preview-wrap {
  display: none;
  margin-top: 16px;
  border-radius: var(--radius);
  overflow: hidden;
  border: 1px solid var(--gray-200);
}
#preview-wrap img {
  width: 100%;
  display: block;
  max-height: 320px;
  object-fit: contain;
  background: var(--gray-900);
}

/* ═══════════════════════════════════════════
   FORM FIELDS
═══════════════════════════════════════════ */
.field-group {
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.field label {
  display: block;
  font-size: 12px;
  font-weight: 600;
  color: var(--gray-700);
  margin-bottom: 6px;
  letter-spacing: 0.2px;
}

.field select {
  width: 100%;
  background: var(--white);
  border: 1px solid var(--gray-200);
  color: var(--gray-900);
  padding: 10px 36px 10px 12px;
  border-radius: var(--radius);
  font-family: 'Sora', sans-serif;
  font-size: 13px;
  cursor: pointer;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%238a8780' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  transition: border-color .15s, box-shadow .15s;
  box-shadow: var(--shadow-sm);
}

.field select:focus {
  outline: none;
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(26, 86, 219, .1);
}

/* ═══════════════════════════════════════════
   BUTTON
═══════════════════════════════════════════ */
.btn-primary {
  width: 100%;
  background: var(--blue);
  color: white;
  font-family: 'Sora', sans-serif;
  font-size: 14px;
  font-weight: 600;
  border: none;
  border-radius: var(--radius);
  padding: 13px 24px;
  cursor: pointer;
  transition: background .15s, transform .1s, box-shadow .15s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  box-shadow: 0 2px 8px rgba(26,86,219,.25);
  letter-spacing: -0.1px;
  margin-top: 20px;
}

.btn-primary:hover { background: var(--blue-dark); box-shadow: 0 4px 16px rgba(26,86,219,.3); }
.btn-primary:active { transform: scale(0.98); }
.btn-primary:disabled { opacity: 0.45; cursor: not-allowed; transform: none; }

/* ═══════════════════════════════════════════
   PROGRESS / SPINNER
═══════════════════════════════════════════ */
#progress-panel {
  display: none;
  grid-column: 1 / -1;
}

.progress-card {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  padding: 32px;
  box-shadow: var(--shadow-sm);
}

.progress-header {
  display: flex;
  align-items: center;
  gap: 14px;
  margin-bottom: 28px;
}

.spinner {
  width: 22px; height: 22px;
  border: 2.5px solid var(--gray-200);
  border-top-color: var(--blue);
  border-radius: 50%;
  animation: spin .7s linear infinite;
  flex-shrink: 0;
}
@keyframes spin { to { transform: rotate(360deg); } }

.progress-header p {
  font-size: 14px;
  font-weight: 600;
  color: var(--gray-900);
}
.progress-header small {
  display: block;
  font-size: 12px;
  color: var(--gray-500);
  font-weight: 400;
  margin-top: 1px;
}

.bridges-progress {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

.bp-item {
  background: var(--gray-50);
  border: 1px solid var(--gray-200);
  border-radius: 8px;
  padding: 10px 12px;
  transition: background .3s, border-color .3s;
}

.bp-item.active {
  background: var(--blue-light);
  border-color: rgba(26,86,219,.2);
}

.bp-item.done {
  background: var(--green-bg);
  border-color: rgba(22,101,52,.15);
}

.bp-item .bp-num {
  font-family: 'DM Mono', monospace;
  font-size: 9px;
  color: var(--gray-500);
  font-weight: 500;
}

.bp-item.active .bp-num { color: var(--blue); }
.bp-item.done .bp-num { color: var(--green); }

.bp-item .bp-name {
  font-size: 12px;
  font-weight: 600;
  color: var(--gray-700);
  margin-top: 2px;
}
.bp-item.active .bp-name { color: var(--blue-dark); }
.bp-item.done .bp-name { color: var(--green); }

/* ═══════════════════════════════════════════
   RESULTS
═══════════════════════════════════════════ */
#results-panel {
  display: none;
  grid-column: 1 / -1;
}

.results-grid {
  display: grid;
  gap: 12px;
}

/* Bridge result row */
.bridge-result {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  padding: 20px 24px;
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 16px;
  align-items: center;
  box-shadow: var(--shadow-sm);
  opacity: 0;
  transform: translateY(8px);
  transition: opacity .35s, transform .35s;
}

.bridge-result.in { opacity: 1; transform: translateY(0); }

.br-label {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  min-width: 56px;
}

.br-num {
  font-family: 'DM Mono', monospace;
  font-size: 9px;
  font-weight: 500;
  color: var(--gray-500);
}

.br-icon {
  width: 40px; height: 40px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  font-weight: 500;
  color: white;
  flex-shrink: 0;
}

.br-name {
  font-size: 11px;
  font-weight: 600;
  color: var(--gray-700);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.br-body { flex: 1; }

.br-title-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}

.br-bridge-name {
  font-size: 15px;
  font-weight: 700;
  color: var(--gray-900);
  letter-spacing: -0.2px;
}

.br-status {
  font-size: 11px;
  font-weight: 600;
  padding: 2px 9px;
  border-radius: 99px;
  letter-spacing: 0.3px;
}

.status-solid   { background: var(--green-bg);  color: var(--green); }
.status-mejora  { background: var(--yellow-bg); color: var(--yellow); }
.status-critica { background: var(--red-bg);    color: var(--red); }

.br-bar {
  height: 4px;
  background: var(--gray-100);
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 8px;
}

.br-fill {
  height: 100%;
  border-radius: 2px;
  transition: width 1s cubic-bezier(.4,0,.2,1);
}

.br-summary {
  font-size: 13px;
  color: var(--gray-500);
  line-height: 1.6;
}

.br-score-box {
  text-align: center;
  min-width: 56px;
}

.br-score-num {
  font-family: 'DM Mono', monospace;
  font-size: 24px;
  font-weight: 500;
  line-height: 1;
}

.br-score-den {
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  color: var(--gray-300);
}

/* ═══════════════════════════════════════════
   GLOBAL SCORE
═══════════════════════════════════════════ */
.global-card {
  background: var(--gray-900);
  border-radius: var(--radius-lg);
  padding: 36px 40px;
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 32px;
  align-items: center;
  margin-top: 12px;
}

.global-score-display {
  text-align: center;
}

.global-score-num {
  font-family: 'DM Mono', monospace;
  font-size: 64px;
  font-weight: 400;
  color: white;
  line-height: 1;
}

.global-score-den {
  font-family: 'DM Mono', monospace;
  font-size: 20px;
  color: var(--gray-500);
}

.global-score-label {
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--gray-500);
  margin-top: 6px;
  font-family: 'DM Mono', monospace;
}

.global-divider {
  width: 1px;
  height: 80px;
  background: rgba(255,255,255,.1);
}

.global-text h3 {
  font-size: 12px;
  font-weight: 600;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--gray-500);
  font-family: 'DM Mono', monospace;
  margin-bottom: 10px;
}

.global-text p {
  font-size: 15px;
  color: rgba(255,255,255,.7);
  line-height: 1.65;
}

/* ═══════════════════════════════════════════
   SYNTHESIS
═══════════════════════════════════════════ */
.synthesis-card {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  margin-top: 12px;
}

.synthesis-card .sc-header {
  padding: 18px 24px;
  border-bottom: 1px solid var(--gray-100);
  display: flex;
  align-items: center;
  gap: 10px;
}

.synthesis-card .sc-header h3 {
  font-size: 14px;
  font-weight: 600;
  color: var(--gray-900);
}

.synthesis-card .sc-header .sc-dot {
  width: 8px; height: 8px;
  background: var(--blue);
  border-radius: 50%;
}

.synthesis-sections {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
}

.syn-section {
  padding: 24px;
  border-right: 1px solid var(--gray-100);
}
.syn-section:last-child { border-right: none; }

.syn-section h4 {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--gray-500);
  font-family: 'DM Mono', monospace;
  margin-bottom: 14px;
}

.syn-section ul {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.syn-section li {
  font-size: 13px;
  color: var(--gray-700);
  line-height: 1.55;
  padding-left: 14px;
  position: relative;
}

.syn-section li::before {
  content: '';
  position: absolute;
  left: 0; top: 8px;
  width: 5px; height: 5px;
  border-radius: 50%;
  background: var(--blue);
}

/* ═══════════════════════════════════════════
   CTA BOTTOM
═══════════════════════════════════════════ */
.cta-section {
  margin-top: 12px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.cta-card {
  border-radius: var(--radius-lg);
  padding: 24px;
  text-decoration: none;
  display: block;
  transition: transform .15s, box-shadow .15s;
}

.cta-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.cta-card.cta-dark {
  background: var(--gray-900);
  border: 1px solid var(--gray-900);
}

.cta-card.cta-blue {
  background: var(--blue);
  border: 1px solid var(--blue);
}

.cta-card .cta-label {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 2px;
  text-transform: uppercase;
  font-family: 'DM Mono', monospace;
  color: rgba(255,255,255,.5);
  margin-bottom: 8px;
}

.cta-card .cta-title {
  font-size: 16px;
  font-weight: 700;
  color: white;
  letter-spacing: -0.3px;
  margin-bottom: 6px;
}

.cta-card .cta-desc {
  font-size: 13px;
  color: rgba(255,255,255,.6);
  line-height: 1.5;
}

.cta-card .cta-arrow {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-top: 14px;
  font-size: 13px;
  font-weight: 600;
  color: white;
}

/* ═══════════════════════════════════════════
   SIDEBAR STICKY INFO
═══════════════════════════════════════════ */
.sidebar-info {
  background: var(--gray-50);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  padding: 20px;
  position: sticky;
  top: 80px;
}

.sidebar-info h4 {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--gray-500);
  font-family: 'DM Mono', monospace;
  margin-bottom: 14px;
}

.info-row {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.info-item {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: 8px;
  padding: 10px 12px;
}

.info-item .info-key {
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--gray-500);
  font-family: 'DM Mono', monospace;
  margin-bottom: 3px;
}

.info-item .info-val {
  font-size: 13px;
  font-weight: 500;
  color: var(--gray-900);
}

/* ═══════════════════════════════════════════
   ERROR TOAST
═══════════════════════════════════════════ */
#error-box {
  display: none;
  background: var(--red-bg);
  border: 1px solid rgba(153,27,27,.2);
  border-radius: var(--radius);
  padding: 12px 16px;
  font-size: 13px;
  color: var(--red);
  margin-top: 12px;
}

/* ═══════════════════════════════════════════
   RESPONSIVE
═══════════════════════════════════════════ */
@media (max-width: 720px) {
  .hero-inner { grid-template-columns: 1fr; }
  .bridge-strip { display: none; }
  .layout { grid-template-columns: 1fr; padding: 24px 16px 60px; gap: 16px; }
  .bridges-progress { grid-template-columns: repeat(2, 1fr); }
  .synthesis-sections { grid-template-columns: 1fr; }
  .cta-section { grid-template-columns: 1fr; }
  .global-card { grid-template-columns: 1fr; gap: 20px; }
  .global-divider { display: none; }
  .bridge-result { grid-template-columns: auto 1fr; }
  .br-score-box { display: none; }
  .hero { padding: 40px 20px 32px; }
  .topbar { padding: 0 20px; }
}
</style>
</head>
<body>

<!-- TOPBAR -->
<nav class="topbar">
  <a class="topbar-brand" href="#">
    <span class="wordmark">HMI Analyzer</span>
    <span class="badge">Beta</span>
  </a>
  <div class="topbar-right">
    <a class="topbar-link" href="https://hmidesign.es/" target="_blank">HMI Design Observatory</a>
    <a class="topbar-link" href="https://bigd.es/contacto/" target="_blank">Contacto</a>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-inner">
    <div>
      <div class="hero-eyebrow">The Cognitive Joint — Evaluación UX Industrial</div>
      <h1>Analiza el diseño cognitivo<br>de cualquier <em>interfaz HMI</em></h1>
      <p>Sube una imagen y obtén una evaluación crítica basada en los 8 puentes cognitivos: visibilidad del estado, jerarquía visual, alertas, guiado, accesibilidad y más.</p>
    </div>
    <div class="bridge-strip">
      <div class="bridge-pill"><span class="num">01</span><span class="label">Orientar</span></div>
      <div class="bridge-pill"><span class="num">02</span><span class="label">Enfocar</span></div>
      <div class="bridge-pill"><span class="num">03</span><span class="label">Advertir</span></div>
      <div class="bridge-pill"><span class="num">04</span><span class="label">Entender</span></div>
      <div class="bridge-pill"><span class="num">05</span><span class="label">Proyectar</span></div>
      <div class="bridge-pill"><span class="num">06</span><span class="label">Guiar</span></div>
      <div class="bridge-pill"><span class="num">07</span><span class="label">Acceder</span></div>
      <div class="bridge-pill"><span class="num">08</span><span class="label">Aprender</span></div>
    </div>
  </div>
</section>

<!-- LAYOUT -->
<div class="layout" id="main-layout">

  <!-- LEFT COLUMN (form) -->
  <div style="display:flex; flex-direction:column; gap:16px;">

    <!-- UPLOAD -->
    <div class="card">
      <div class="card-header">
        <div class="step">1</div>
        <h2>Imagen de la interfaz HMI</h2>
      </div>
      <div class="card-body">
        <div class="upload-zone" id="dropzone">
          <input type="file" id="fileInput" accept=".png,.jpg,.jpeg">
          <div class="upload-icon">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M9 11V3M4 8l5-5 5 5" stroke="#1a56db" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 14h14" stroke="#1a56db" stroke-width="1.8" stroke-linecap="round"/></svg>
          </div>
          <p><strong>Haz clic para subir</strong> o arrastra aquí</p>
          <small style="margin-top:4px; display:block;">PNG, JPG, JPEG</small>
        </div>

        <div class="file-chosen" id="fileChosen">
          <div class="file-icon">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="2" y="1" width="9" height="13" rx="1.5" stroke="#1a56db" stroke-width="1.5"/><path d="M5 5h5M5 8h3" stroke="#1a56db" stroke-width="1.5" stroke-linecap="round"/></svg>
          </div>
          <span class="file-name" id="fileName">—</span>
          <span class="file-size" id="fileSize">—</span>
        </div>

        <div id="preview-wrap">
          <img id="preview-img" src="" alt="HMI preview">
        </div>
      </div>
    </div>

    <!-- CONFIG -->
    <div class="card">
      <div class="card-header">
        <div class="step">2</div>
        <h2>Condiciones operativas del sistema</h2>
      </div>
      <div class="card-body">
        <div class="field-group">
          <div class="field">
            <label>Tipo de sistema</label>
            <select id="tipo_sistema">
              <option>Producción</option>
              <option>Seguridad</option>
              <option>Emergencia</option>
              <option>Mantenimiento</option>
            </select>
          </div>
          <div class="field">
            <label>Nivel de criticidad</label>
            <select id="nivel_criticidad">
              <option>Bajo (errores reversibles, bajo impacto)</option>
              <option>Medio (impacto operativo relevante)</option>
              <option>Alto (impacto en seguridad, coste o parada de línea)</option>
            </select>
          </div>
          <div class="field">
            <label>Perfil del usuario</label>
            <select id="perfil_usuario">
              <option>Operador experto</option>
              <option>Operador nuevo</option>
              <option>Supervisor / ingeniero</option>
            </select>
          </div>
          <div class="field">
            <label>Entorno operativo</label>
            <select id="entorno_operativo">
              <option>Normal</option>
              <option>Alta presión (ritmo elevado, picos de carga)</option>
              <option>Emergencia</option>
            </select>
          </div>
        </div>

        <div id="error-box"></div>

        <button class="btn-primary" id="btnAnalyze" disabled>
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><circle cx="8" cy="8" r="6" stroke="white" stroke-width="1.5"/><path d="M5.5 8l2 2 3-3" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Analizar HMI
        </button>
      </div>
    </div>
  </div>

  <!-- RIGHT COLUMN (sidebar) -->
  <div class="sidebar-info" id="sidebar-info">
    <h4>Configuración activa</h4>
    <div class="info-row">
      <div class="info-item">
        <div class="info-key">Sistema</div>
        <div class="info-val" id="s-sistema">—</div>
      </div>
      <div class="info-item">
        <div class="info-key">Criticidad</div>
        <div class="info-val" id="s-criticidad">—</div>
      </div>
      <div class="info-item">
        <div class="info-key">Usuario</div>
        <div class="info-val" id="s-usuario">—</div>
      </div>
      <div class="info-item">
        <div class="info-key">Entorno</div>
        <div class="info-val" id="s-entorno">—</div>
      </div>
    </div>
  </div>

  <!-- PROGRESS (spans full width) -->
  <div id="progress-panel">
    <div class="progress-card">
      <div class="progress-header">
        <div class="spinner"></div>
        <div>
          <p id="progress-title">Iniciando análisis…</p>
          <small id="progress-sub">Analizando interfaz según los 8 Puentes Cognitivos</small>
        </div>
      </div>
      <div class="bridges-progress" id="bridges-progress">
        <div class="bp-item" data-idx="0"><div class="bp-num">P·01</div><div class="bp-name">Orientar</div></div>
        <div class="bp-item" data-idx="1"><div class="bp-num">P·02</div><div class="bp-name">Enfocar</div></div>
        <div class="bp-item" data-idx="2"><div class="bp-num">P·03</div><div class="bp-name">Advertir</div></div>
        <div class="bp-item" data-idx="3"><div class="bp-num">P·04</div><div class="bp-name">Entender</div></div>
        <div class="bp-item" data-idx="4"><div class="bp-num">P·05</div><div class="bp-name">Proyectar</div></div>
        <div class="bp-item" data-idx="5"><div class="bp-num">P·06</div><div class="bp-name">Guiar</div></div>
        <div class="bp-item" data-idx="6"><div class="bp-num">P·07</div><div class="bp-name">Acceder</div></div>
        <div class="bp-item" data-idx="7"><div class="bp-num">P·08</div><div class="bp-name">Aprender</div></div>
      </div>
    </div>
  </div>

  <!-- RESULTS (spans full width) -->
  <div id="results-panel">

    <div style="font-size:12px; font-weight:700; letter-spacing:2px; text-transform:uppercase; color:var(--gray-500); font-family:'DM Mono',monospace; margin-bottom:16px;">
      Resultados — Evaluación por puente cognitivo
    </div>

    <div class="results-grid" id="results-grid"></div>

    <!-- Global -->
    <div class="global-card" id="global-card">
      <div class="global-score-display">
        <div class="global-score-num" id="global-num">—</div>
        <div class="global-score-den">/10</div>
        <div class="global-score-label">Calidad UX HMI</div>
      </div>
      <div class="global-divider"></div>
      <div class="global-text">
        <h3>Resultado global</h3>
        <p id="global-text-body">Puntuación media ponderada de los 8 puentes cognitivos evaluados sobre la interfaz analizada.</p>
      </div>
    </div>

    <!-- Synthesis -->
    <div class="synthesis-card" id="synthesis-card" style="display:none;">
      <div class="sc-header">
        <div class="sc-dot"></div>
        <h3>Síntesis final</h3>
      </div>
      <div class="synthesis-sections" id="synthesis-sections"></div>
    </div>

    <!-- CTA -->
    <div class="cta-section">
      <a class="cta-card cta-dark" href="https://bigd.es/contacto/" target="_blank">
        <div class="cta-label">Servicio profesional</div>
        <div class="cta-title">Análisis en profundidad</div>
        <div class="cta-desc">Diagnóstico completo con contexto de uso real, flujos operativos y criterios industriales.</div>
        <div class="cta-arrow">Solicitar →</div>
      </a>
      <a class="cta-card cta-blue" href="https://hmidesign.es/" target="_blank">
        <div class="cta-label">Recursos</div>
        <div class="cta-title">HMI Design Observatory</div>
        <div class="cta-desc">Informes, herramientas y recursos sobre diseño HMI industrial.</div>
        <div class="cta-arrow">Explorar →</div>
      </a>
    </div>

  </div>

</div><!-- /layout -->

<script>
// ── DOM refs ──
const dropzone     = document.getElementById('dropzone');
const fileInput    = document.getElementById('fileInput');
const fileChosen   = document.getElementById('fileChosen');
const fileName     = document.getElementById('fileName');
const fileSize     = document.getElementById('fileSize');
const previewWrap  = document.getElementById('preview-wrap');
const previewImg   = document.getElementById('preview-img');
const btnAnalyze   = document.getElementById('btnAnalyze');
const progressPanel= document.getElementById('progress-panel');
const resultsPanel = document.getElementById('results-panel');
const resultsGrid  = document.getElementById('results-grid');
const errorBox     = document.getElementById('error-box');
const layout       = document.getElementById('main-layout');

// Sidebar live update
const selectors = ['tipo_sistema','nivel_criticidad','perfil_usuario','entorno_operativo'];
const sideKeys  = ['s-sistema','s-criticidad','s-usuario','s-entorno'];
selectors.forEach((id, i) => {
  const el = document.getElementById(id);
  const updateSide = () => {
    document.getElementById(sideKeys[i]).textContent = el.value;
  };
  updateSide();
  el.addEventListener('change', updateSide);
});

// ── FILE HANDLING ──
fileInput.addEventListener('change', e => handleFile(e.target.files[0]));

dropzone.addEventListener('dragover', e => { e.preventDefault(); dropzone.classList.add('over'); });
dropzone.addEventListener('dragleave', () => dropzone.classList.remove('over'));
dropzone.addEventListener('drop', e => {
  e.preventDefault();
  dropzone.classList.remove('over');
  if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
});

function handleFile(file) {
  if (!file) return;
  fileName.textContent = file.name;
  fileSize.textContent = (file.size / 1024).toFixed(0) + ' KB';
  fileChosen.style.display = 'flex';

  const reader = new FileReader();
  reader.onload = ev => {
    previewImg.src = ev.target.result;
    previewWrap.style.display = 'block';
    btnAnalyze.disabled = false;
  };
  reader.readAsDataURL(file);
}

// ── BRIDGE NAMES ──
const BRIDGE_NAMES = ['Orientar','Enfocar','Advertir','Entender','Proyectar','Guiar','Acceder','Aprender'];
const BRIDGE_COLORS = ['#1a56db','#0891b2','#0d9488','#059669','#7c3aed','#db2777','#ea580c','#ca8a04'];

// ── ANALYZE ──
btnAnalyze.addEventListener('click', runAnalysis);

async function runAnalysis() {
  const file = fileInput.files[0];
  if (!file) return;

  errorBox.style.display = 'none';
  btnAnalyze.disabled = true;
  resultsPanel.style.display = 'none';
  resultsGrid.innerHTML = '';

  // Show progress, hide sidebar
  document.getElementById('sidebar-info').style.display = 'none';
  progressPanel.style.display = 'block';
  layout.style.gridTemplateColumns = '1fr';

  // Reset bridge progress items
  document.querySelectorAll('.bp-item').forEach(el => {
    el.classList.remove('active','done');
  });

  document.getElementById('progress-title').textContent = 'Enviando imagen al servidor…';

  const formData = new FormData();
  formData.append('file', file);
  formData.append('tipo_sistema',      document.getElementById('tipo_sistema').value);
  formData.append('nivel_criticidad',  document.getElementById('nivel_criticidad').value);
  formData.append('perfil_usuario',    document.getElementById('perfil_usuario').value);
  formData.append('entorno_operativo', document.getElementById('entorno_operativo').value);

  // Simulate bridge-by-bridge progress while waiting
  let bridgeIdx = 0;
  const progressInterval = setInterval(() => {
    if (bridgeIdx > 0) {
      document.querySelector(`.bp-item[data-idx="${bridgeIdx-1}"]`).classList.replace('active','done');
    }
    if (bridgeIdx < 8) {
      const item = document.querySelector(`.bp-item[data-idx="${bridgeIdx}"]`);
      item.classList.add('active');
      document.getElementById('progress-title').textContent =
        `Analizando Puente ${String(bridgeIdx+1).padStart(2,'0')} — ${BRIDGE_NAMES[bridgeIdx]}…`;
    }
    bridgeIdx++;
    if (bridgeIdx > 8) clearInterval(progressInterval);
  }, 3200);

  try {
    const res = await fetch('/analyze', { method: 'POST', body: formData });
    clearInterval(progressInterval);

    // Mark all done
    document.querySelectorAll('.bp-item').forEach(el => {
      el.classList.remove('active');
      el.classList.add('done');
    });
    document.getElementById('progress-title').textContent = 'Generando síntesis final…';

    await delay(600);

    if (!res.ok) throw new Error(`Error del servidor: ${res.status}`);
    const data = await res.json();
    if (data.error) throw new Error(data.error);

    renderResults(data);

  } catch (err) {
    clearInterval(progressInterval);
    progressPanel.style.display = 'none';
    document.getElementById('sidebar-info').style.display = 'block';
    layout.style.gridTemplateColumns = '1fr 320px';
    errorBox.textContent = '⚠ ' + err.message;
    errorBox.style.display = 'block';
    btnAnalyze.disabled = false;
  }
}

function renderResults(data) {
  progressPanel.style.display = 'none';
  resultsPanel.style.display = 'block';

  // Render bridge cards with stagger
  data.bridges.forEach((b, i) => {
    setTimeout(() => {
      const card = buildBridgeCard(b, i);
      resultsGrid.appendChild(card);
      requestAnimationFrame(() => requestAnimationFrame(() => card.classList.add('in')));
    }, i * 80);
  });

  // Global score
  setTimeout(() => {
    document.getElementById('global-num').textContent = data.average;
  }, data.bridges.length * 80 + 100);

  // Synthesis
  setTimeout(() => {
    renderSynthesis(data.synthesis);
    resultsPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, data.bridges.length * 80 + 400);
}

function buildBridgeCard(b, idx) {
  const score  = b.score;
  const color  = BRIDGE_COLORS[idx];
  const label  = score >= 7 ? 'Sólida' : score >= 5 ? 'Mejorable' : 'Crítica';
  const cls    = score >= 7 ? 'status-solid' : score >= 5 ? 'status-mejora' : 'status-critica';
  const barClr = score >= 7 ? '#16a34a' : score >= 5 ? '#ca8a04' : '#dc2626';
  const numStr = String(idx + 1).padStart(2, '0');
  const name   = BRIDGE_NAMES[idx];

  const div = document.createElement('div');
  div.className = 'bridge-result';
  div.innerHTML = `
    <div class="br-label">
      <div class="br-num">P·${numStr}</div>
      <div class="br-icon" style="background:${color}">${numStr}</div>
      <div class="br-name">${name}</div>
    </div>
    <div class="br-body">
      <div class="br-title-row">
        <span class="br-bridge-name">${name}</span>
        <span class="br-status ${cls}">${label}</span>
      </div>
      <div class="br-bar"><div class="br-fill" style="background:${barClr}; width:0%;" data-w="${score*10}"></div></div>
      <div class="br-summary">${b.summary}</div>
    </div>
    <div class="br-score-box">
      <div class="br-score-num" style="color:${barClr}">${score}</div>
      <div class="br-score-den">/10</div>
    </div>
  `;

  // Animate bar
  requestAnimationFrame(() => requestAnimationFrame(() => {
    const fill = div.querySelector('.br-fill');
    if (fill) fill.style.width = fill.dataset.w + '%';
  }));

  return div;
}

function renderSynthesis(text) {
  const sections = { 'OBSERVACIONES CLAVE': [], 'IMPACTO OPERATIVO': [], 'OPORTUNIDADES DE MEJORA': [] };
  let current = null;

  text.split('\n').forEach(line => {
    line = line.trim();
    if (!line) return;
    const key = Object.keys(sections).find(k => line.toUpperCase().includes(k));
    if (key) { current = key; return; }
    if (current && line.startsWith('-')) {
      sections[current].push(line.replace(/^-+\s*/, ''));
    }
  });

  const container = document.getElementById('synthesis-sections');
  const titleMap  = {
    'OBSERVACIONES CLAVE':   'Observaciones',
    'IMPACTO OPERATIVO':     'Impacto operativo',
    'OPORTUNIDADES DE MEJORA': 'Mejoras'
  };

  container.innerHTML = Object.entries(sections).map(([key, items]) => `
    <div class="syn-section">
      <h4>${titleMap[key]}</h4>
      <ul>${items.map(i => `<li>${i}</li>`).join('')}</ul>
    </div>
  `).join('');

  document.getElementById('synthesis-card').style.display = 'block';
}

function delay(ms) { return new Promise(r => setTimeout(r, ms)); }
</script>
</body>
</html>
